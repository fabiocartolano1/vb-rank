name: Update All Championships Daily

# Mise Ã  jour automatique de tous les classements et matchs tous les soirs Ã  23h (heure de Paris)
# Note: GitHub Actions utilise l'heure UTC, donc 23h Paris = 22h UTC (hiver) ou 21h UTC (Ã©tÃ©)

on:
  # ExÃ©cution automatique tous les jours Ã  22h UTC (23h heure de Paris en hiver)
  schedule:
    - cron: '0 22 * * *'

  # Permet aussi de lancer manuellement depuis l'interface GitHub
  workflow_dispatch:

jobs:
  update-all:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install dependencies
        run: npm install

      - name: Setup environment variables
        run: |
          echo "${{ secrets.ENV_FILE }}" > .env

      - name: Create logs directory
        run: mkdir -p logs

      # Nationale 3 FÃ©minine
      - name: Update Classement N3F
        run: npm run update:classement-n3
        continue-on-error: true

      - name: Update Matchs N3F
        run: npm run update:matchs-n3
        continue-on-error: true

      # PrÃ©-nationale FÃ©minine
      - name: Update Classement PNF
        run: npm run update:classement-pnf
        continue-on-error: true

      - name: Update Matchs PNF
        run: npm run update:matchs-pnf
        continue-on-error: true

      # PrÃ©-nationale Masculine
      - name: Update Classement PNM
        run: npm run update:classement-pnm
        continue-on-error: true

      - name: Update Matchs PNM
        run: npm run update:matchs-pnm
        continue-on-error: true

      # RÃ©gionale 2 FÃ©minine
      - name: Update Classement R2F
        run: npm run update:classement-r2f
        continue-on-error: true

      - name: Update Matchs R2F
        run: npm run update:matchs-r2f
        continue-on-error: true

      # RÃ©gionale 2 Masculine
      - name: Update Classement R2M
        run: npm run update:classement-r2m
        continue-on-error: true

      - name: Update Matchs R2M
        run: npm run update:matchs-r2m
        continue-on-error: true

      # M18 Masculine
      - name: Update Classement M18M
        run: npm run update:classement-m18m
        continue-on-error: true

      - name: Update Matchs M18M
        run: npm run update:matchs-m18m
        continue-on-error: true

      # BFC (Benjamines FÃ©minines CritÃ©rium)
      - name: Update Classement BFC
        run: npm run update:classement-bfc
        continue-on-error: true

      - name: Update Matchs BFC
        run: npm run update:matchs-bfc
        continue-on-error: true

      # BMB (Benjamins Masculins Bronze)
      - name: Update Classement BMB
        run: npm run update:classement-bmb
        continue-on-error: true

      - name: Update Matchs BMB
        run: npm run update:matchs-bmb
        continue-on-error: true

      # CFD (Cadettes FÃ©minines DÃ©partemental)
      - name: Update Classement CFD
        run: npm run update:classement-cfd
        continue-on-error: true

      - name: Update Matchs CFD
        run: npm run update:matchs-cfd
        continue-on-error: true

      # MFD (Minimes FÃ©minines DÃ©partemental)
      - name: Update Classement MFD
        run: npm run update:classement-mfd
        continue-on-error: true

      - name: Update Matchs MFD
        run: npm run update:matchs-mfd
        continue-on-error: true

      # MMB (Minimes Masculins Bronze)
      - name: Update Classement MMB
        run: npm run update:classement-mmb
        continue-on-error: true

      - name: Update Matchs MMB
        run: npm run update:matchs-mmb
        continue-on-error: true

      - name: Upload logs
        uses: actions/upload-artifact@v4
        if: always() # Uploader les logs mÃªme en cas d'erreur
        with:
          name: daily-update-logs-${{ github.run_id }}
          path: logs/*.log
          retention-days: 30

      - name: Summary
        if: always()
        run: |
          echo "âœ… Mise Ã  jour quotidienne terminÃ©e"
          echo "ðŸ“Š Consultez les logs dans les artifacts pour plus de dÃ©tails"
